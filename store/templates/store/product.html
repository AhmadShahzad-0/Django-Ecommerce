{% extends 'store/base.html' %}

{% block content %}



<div class="container my-5">
    <div class="card border-0 shadow-lg">
        <div class="row g-0 align-items-center">
            <!-- Product Image -->
            <div class="col-md-5">
                <img src="{{ product.image.url }}" class="img-fluid rounded-start w-100 h-100 object-fit-cover" alt="{{ product.name }}">
            </div>

            <!-- Product Details -->
            <div class="col-md-7">
                <div class="card-body p-4">
                    <h3 class="card-title fw-bold text-center mb-3">{{ product.name }}</h3>

                    <p class="text-center text-muted mb-4">
                        {{ product.category }}<br>
                        <span class="small">{{ product.description }}</span>
                    </p>

                    <!-- Product Price -->
                    <div class="text-center mb-4">
                        {% if product.is_on_sale %}
                            <span class="text-muted text-decoration-line-through">${{ product.price }}</span>
                            <span class="text-danger fw-semibold ms-2">${{ product.sale_price }}</span>
                        {% else %}
                            <span class="fw-semibold">${{ product.price }}</span>
                        {% endif %}
                    </div>

                    <!-- Quantity Selector -->
                    <div class="row justify-content-center align-items-center mb-4">
                        <div class="col-auto">
                            <label for="qty-cart" class="col-form-label fw-semibold">Quantity:</label>
                        </div>
                        <div class="col-auto">
                            <select class="form-select form-select-sm" id="qty-cart">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="text-center">
                        <a href="{% url 'home' %}" class="btn btn-outline-secondary me-2">Home</a>
                        <button type="button" value="{{ product.id }}" class="btn btn-dark" id="add-cart">
                            Add To Cart
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br>

<script>
    // Check if Button Pressed
    $(document).on('click', '#add-cart', function(e){
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url "cart_add" %}',
            data: {
                'product_id': $('#add-cart').val(),
                'product_qty': $('#qty-cart option:selected').text(),
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                'action': 'post'
            },
            success: function(json){
                //console.log(json);
                document.getElementById("cart_quantity").textContent = json.qty
                location.reload();
            },
            error: function(xhr, errmsg, err){
                console.error("AJAX error:", errmsg);
            }
        });
    });
</script>


{% endblock %}